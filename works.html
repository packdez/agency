<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Works | Packdez</title>

  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #298e55 0%, #1a5d38 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(8px);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      z-index: 1000;
    }

    .modal-container {
      background: #ffffff;
      width: 100%;
      height: 100vh;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 24px;
      border-bottom: 1px solid #e5e7eb;
      flex-shrink: 0;
      gap: 12px;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 8px;
      flex: 1;
    }

    .header-controls {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-shrink: 0;
    }

    .btn {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      background: #f3f4f6;
      border: 1px solid #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .btn:hover:not(:disabled) {
      background: #298e55;
      color: white;
      border-color: #298e55;
    }

    .btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    .btn-close:hover {
      background: #dc2626;
      color: white;
      border-color: #dc2626;
      transform: rotate(90deg);
    }

    /* Project Dropdown */
    .project-dropdown {
      position: relative;
      width: 100%;
      max-width: 280px;
    }

    .dropdown-btn {
      width: 100%;
      height: 40px;
      padding: 0 12px;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 14px;
      font-weight: 500;
      color: #111827;
    }

    .dropdown-btn:hover {
      background: #e5e7eb;
      border-color: #d1d5db;
    }

    .dropdown-btn.active {
      background: #298e55;
      color: white;
      border-color: #298e55;
    }

    .dropdown-menu {
      position: absolute;
      top: calc(100% + 8px);
      left: 0;
      right: 0;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      max-height: 400px;
      overflow: hidden;
      display: none;
      flex-direction: column;
      z-index: 1000;
    }

    .dropdown-menu.show {
      display: flex;
    }

    .dropdown-search {
      padding: 12px;
      border-bottom: 1px solid #e5e7eb;
    }

    .dropdown-search input {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      font-size: 14px;
      outline: none;
      transition: border-color 0.2s;
    }

    .dropdown-search input:focus {
      border-color: #298e55;
    }

    .dropdown-list {
      overflow-y: auto;
      max-height: 320px;
    }

    .dropdown-list::-webkit-scrollbar {
      width: 6px;
    }

    .dropdown-list::-webkit-scrollbar-track {
      background: transparent;
    }

    .dropdown-list::-webkit-scrollbar-thumb {
      background: #d1d5db;
      border-radius: 3px;
    }

    .dropdown-item {
      padding: 12px 16px;
      cursor: pointer;
      transition: background 0.15s;
      border-bottom: 1px solid #f3f4f6;
      font-size: 14px;
      color: #374151;
    }

    .dropdown-item:hover {
      background: #f9fafb;
    }

    .dropdown-item.active {
      background: rgba(41, 142, 85, 0.1);
      color: #298e55;
      font-weight: 600;
    }

    .dropdown-item:last-child {
      border-bottom: none;
    }

    .dropdown-item-title {
      font-weight: 500;
      color: #111827;
      margin-bottom: 2px;
    }

    .dropdown-item.active .dropdown-item-title {
      color: #298e55;
    }

    .dropdown-item-category {
      font-size: 12px;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .no-results {
      padding: 20px;
      text-align: center;
      color: #6b7280;
      font-size: 14px;
    }

    /* Share Modal */
    .share-modal-overlay {
      position: fixed;
      inset: 0;
      backdrop-filter: blur(8px);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 16px;
      z-index: 2000;
      animation: fadeIn 0.2s ease-out;
    }

    .share-modal-overlay.show {
      display: flex;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes zoomIn {
      from {
        opacity: 0;
        transform: scale(0.95);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .share-modal {
      background: white;
      border-radius: 16px;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      width: 100%;
      max-width: 448px;
      overflow: hidden;
      animation: zoomIn 0.2s ease-out;
    }

    .share-modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 24px;
      border-bottom: 1px solid #e5e7eb;
    }

    .share-modal-title {
      font-size: 20px;
      font-weight: 700;
      color: #111827;
    }

    .share-close-btn {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      background: #f3f4f6;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .share-close-btn:hover {
      background: #dc2626;
      color: white;
      transform: rotate(90deg);
    }

    .share-project-info {
      padding: 16px 24px;
      background: linear-gradient(to right, rgba(41, 142, 85, 0.1), rgba(26, 93, 56, 0.1));
      border-bottom: 1px solid #e5e7eb;
    }

    .share-project-category {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #298e55;
      margin-bottom: 4px;
    }

    .share-project-title {
      font-size: 16px;
      font-weight: 600;
      color: #111827;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .share-options {
      padding: 16px;
    }

    .share-option {
      width: 100%;
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 16px;
      margin-bottom: 8px;
      border-radius: 12px;
      border: 2px solid #e5e7eb;
      background: white;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
    }

    .share-option:last-child {
      margin-bottom: 0;
    }

    .share-option:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .share-option.linkedin:hover {
      border-color: #0077b5;
      background: rgba(0, 119, 181, 0.05);
    }

    .share-option.twitter:hover {
      border-color: #000000;
      background: rgba(0, 0, 0, 0.05);
    }

    .share-option.facebook:hover {
      border-color: #1877f2;
      background: rgba(24, 119, 242, 0.05);
    }

    .share-option.copy:hover {
      border-color: #298e55;
      background: rgba(41, 142, 85, 0.05);
    }

    .share-option.copied {
      border-color: #298e55;
      background: rgba(41, 142, 85, 0.05);
    }

    .share-icon-wrapper {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all 0.2s;
    }

    .share-option.linkedin .share-icon-wrapper {
      background: rgba(0, 119, 181, 0.1);
    }

    .share-option.linkedin:hover .share-icon-wrapper {
      background: #0077b5;
    }

    .share-option.twitter .share-icon-wrapper {
      background: rgba(0, 0, 0, 0.1);
    }

    .share-option.twitter:hover .share-icon-wrapper {
      background: #000000;
    }

    .share-option.facebook .share-icon-wrapper {
      background: rgba(24, 119, 242, 0.1);
    }

    .share-option.facebook:hover .share-icon-wrapper {
      background: #1877f2;
    }

    .share-option.copy .share-icon-wrapper {
      background: rgba(41, 142, 85, 0.1);
    }

    .share-option.copy:hover .share-icon-wrapper,
    .share-option.copied .share-icon-wrapper {
      background: #298e55;
    }

    .share-icon {
      width: 24px;
      height: 24px;
      transition: all 0.2s;
    }

    .share-option.linkedin .share-icon {
      color: #0077b5;
    }

    .share-option.linkedin:hover .share-icon {
      color: white;
    }

    .share-option.twitter .share-icon {
      color: #000000;
    }

    .share-option.twitter:hover .share-icon {
      color: white;
    }

    .share-option.facebook .share-icon {
      color: #1877f2;
    }

    .share-option.facebook:hover .share-icon {
      color: white;
    }

    .share-option.copy .share-icon {
      color: #298e55;
    }

    .share-option.copy:hover .share-icon,
    .share-option.copied .share-icon {
      color: white;
    }

    .share-option-content {
      flex: 1;
      min-width: 0;
    }

    .share-option-title {
      font-size: 16px;
      font-weight: 600;
      color: #111827;
      margin-bottom: 2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .share-option.linkedin:hover .share-option-title {
      color: #0077b5;
    }

    .share-option.twitter:hover .share-option-title {
      color: #000000;
    }

    .share-option.facebook:hover .share-option-title {
      color: #1877f2;
    }

    .share-option.copy:hover .share-option-title,
    .share-option.copied .share-option-title {
      color: #298e55;
    }

    .share-option-subtitle {
      font-size: 14px;
      color: #6b7280;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .modal-body {
      flex: 1;
      display: grid;
      grid-template-columns: 1fr 420px;
      overflow: hidden;
    }

    .video-section {
      background: #eeeeee;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .video-container {
      width: 100%;
      max-width: 700px;
      position: relative;
      padding-bottom: 56.25%;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
    }

    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    .details-section {
      background: #fafafa;
      padding: 24px;
      overflow-y: auto;
      border-left: 1px solid #e5e7eb;
    }

    .details-section::-webkit-scrollbar {
      width: 6px;
    }

    .details-section::-webkit-scrollbar-track {
      background: transparent;
    }

    .details-section::-webkit-scrollbar-thumb {
      background: #d1d5db;
      border-radius: 3px;
    }

    .details-section::-webkit-scrollbar-thumb:hover {
      background: #9ca3af;
    }

    .category-badge {
      display: inline-block;
      padding: 6px 12px;
      background: linear-gradient(135deg, rgba(41, 142, 85, 0.15), rgba(41, 142, 85, 0.08));
      color: #298e55;
      border-radius: 9999px;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 12px;
      border: 1px solid rgba(41, 142, 85, 0.2);
    }

    .project-title {
      font-size: 24px;
      font-weight: 700;
      color: #111827;
      margin-bottom: 24px;
      line-height: 1.3;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 24px;
    }

    .stat-card {
      background: #ffffff;
      padding: 16px;
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      transition: all 0.2s ease;
    }

    .stat-card:hover {
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
      transform: translateY(-2px);
    }

    .stat-label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      font-weight: 600;
      color: #6b7280;
      margin-bottom: 8px;
      text-transform: uppercase;
    }

    .stat-value {
      font-size: 24px;
      font-weight: 900;
      color: #111827;
      transition: all 0.3s ease;
    }

    .stat-value.updating {
      animation: pulse 0.4s ease;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.08); color: #298e55; }
    }

    .like-btn {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      margin-bottom: 24px;
      border: 2px solid #e5e7eb;
      background: #ffffff;
      color: #111827;
    }

    .like-btn:hover:not(:disabled) {
      border-color: #298e55;
      background: rgba(41, 142, 85, 0.05);
      color: #298e55;
    }

    .like-btn:disabled {
      background: #298e55;
      color: white;
      border-color: #298e55;
      cursor: not-allowed;
    }

    .like-btn svg.filled {
      fill: currentColor;
    }

    .info-section {
      background: #ffffff;
      padding: 18px;
      border-radius: 10px;
      margin-bottom: 16px;
      border: 1px solid #e5e7eb;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      transition: all 0.2s ease;
    }

    .info-section:hover {
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
      transform: translateY(-1px);
    }

    .info-section:last-child {
      margin-bottom: 0;
    }

    .info-label {
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #298e55;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .info-label::before {
      content: '';
      width: 3px;
      height: 12px;
      background: #298e55;
      border-radius: 2px;
    }

    .info-text {
      font-size: 14px;
      line-height: 1.6;
      color: #374151;
    }

    .icon {
      width: 20px;
      height: 20px;
    }

    .icon-sm {
      width: 16px;
      height: 16px;
    }

    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px;
      color: #6b7280;
    }

    .project-link-wrapper {
      margin-top: 20px;
    }

    .project-link-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 14px;
      text-decoration: none;
      color: #ffffff;
      background: linear-gradient(135deg, #298e55, #1a5d38);
      box-shadow: 0 4px 10px rgba(41, 142, 85, 0.25);
      transition: transform 0.15s ease, box-shadow 0.15s ease, opacity 0.15s ease;
    }

    .project-link-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 14px rgba(41, 142, 85, 0.35);
      opacity: 0.95;
    }

    .project-link-btn:active {
      transform: translateY(0);
      box-shadow: 0 3px 8px rgba(41, 142, 85, 0.25);
    }

    @media (max-width: 1024px) {
      .modal-body {
        grid-template-columns: 1fr;
      }

      .details-section {
        border-left: none;
        border-top: 1px solid #e5e7eb;
      }

      .video-section {
        padding: 16px;
      }
    }

    @media (max-width: 768px) {
      .modal-container {
        height: 90vh;
      }

      .project-title {
        font-size: 20px;
      }

      .modal-header {
        padding: 12px 16px;
      }

      .details-section {
        padding: 16px;
      }

      .btn {
        width: 36px;
        height: 36px;
      }

      .stat-value {
        font-size: 20px;
      }

      .project-dropdown {
        max-width: 200px;
      }

      .dropdown-btn {
        font-size: 13px;
      }

      .share-modal-header {
        padding: 16px 20px;
      }

      .share-modal-title {
        font-size: 18px;
      }

      .share-close-btn {
        width: 36px;
        height: 36px;
      }

      .share-project-info {
        padding: 12px 20px;
      }

      .share-options {
        padding: 12px;
      }

      .share-option {
        padding: 12px;
        gap: 12px;
      }

      .share-icon-wrapper {
        width: 40px;
        height: 40px;
      }

      .share-icon {
        width: 20px;
        height: 20px;
      }

      .share-option-title {
        font-size: 14px;
      }

      .share-option-subtitle {
        font-size: 12px;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 10px;
      }

      .modal-overlay {
        padding: 10px;
      }

      .modal-container {
        height: 95vh;
      }

      .project-title {
        font-size: 18px;
        margin-bottom: 16px;
      }

      .stats-grid {
        gap: 8px;
        margin-bottom: 16px;
      }

      .stat-card {
        padding: 12px;
      }

      .stat-value {
        font-size: 18px;
      }

      .info-section {
        margin-bottom: 12px;
        padding: 14px;
      }

      .project-dropdown {
        max-width: 160px;
      }

      .dropdown-btn {
        font-size: 12px;
        padding: 0 8px;
      }

      .btn {
        width: 32px;
        height: 32px;
      }

      .share-modal-overlay {
        padding: 12px;
      }

      .header-left {
        flex-wrap: wrap;
      }
    }
  </style>
</head>
<body>
  <div class="modal-overlay">
    <div class="modal-container">
      <!-- Header -->
      <div class="modal-header">
        <!-- Left: Project Dropdown & Share Button -->
        <div class="header-left">
          <div class="project-dropdown">
            <button class="dropdown-btn" id="dropdownBtn" onclick="toggleDropdown()">
              <span id="dropdownLabel">All projects</span>
              <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <div class="dropdown-menu" id="dropdownMenu">
              <div class="dropdown-search">
                <input 
                  type="text" 
                  id="searchInput" 
                  placeholder="Search projects..."
                  onkeyup="filterProjects()"
                />
              </div>
              <div class="dropdown-list" id="dropdownList">
                <!-- Projects will be populated here -->
              </div>
            </div>
          </div>

          <!-- Share Button -->
          <button class="btn" id="shareBtn" onclick="toggleShareModal()" title="Share Project">
            <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
            </svg>
          </button>
        </div>

        <!-- Right: Controls -->
        <div class="header-controls">
          <button class="btn" id="prevBtn" onclick="previousProject()">
            <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
            </svg>
          </button>
          <button class="btn" id="nextBtn" onclick="nextProject()">
            <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
          </button>
          <button class="btn btn-close" onclick="closeModal()">
            <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>

      <!-- Body -->
      <div class="modal-body">
        <!-- Video Section -->
        <div class="video-section">
          <div class="video-container" id="videoWrapper">
            <div class="loading">Loading projects...</div>
          </div>
        </div>

        <!-- Details Section -->
        <div class="details-section" id="detailsSection">
          <div class="loading">Loading...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Share Modal -->
  <div class="share-modal-overlay" id="shareModalOverlay" onclick="closeShareModalOnOverlay(event)">
    <div class="share-modal" onclick="event.stopPropagation()">
      <div class="share-modal-header">
        <h3 class="share-modal-title">Share Project</h3>
        <button class="share-close-btn" onclick="toggleShareModal()">
          <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>

      <div class="share-project-info">
        <div class="share-project-category" id="shareCategory">Category</div>
        <div class="share-project-title" id="shareTitle">Project Title</div>
      </div>

      <div class="share-options">
        <button class="share-option linkedin" onclick="shareToLinkedIn()">
          <div class="share-icon-wrapper">
            <svg class="share-icon" fill="currentColor" viewBox="0 0 24 24">
              <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
            </svg>
          </div>
          <div class="share-option-content">
            <div class="share-option-title">Share on LinkedIn</div>
            <div class="share-option-subtitle">Share with your professional network</div>
          </div>
        </button>

        <button class="share-option twitter" onclick="shareToTwitter()">
          <div class="share-icon-wrapper">
            <svg class="share-icon" fill="currentColor" viewBox="0 0 24 24">
              <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
            </svg>
          </div>
          <div class="share-option-content">
            <div class="share-option-title">Share on X</div>
            <div class="share-option-subtitle">Post to your followers</div>
          </div>
        </button>

        <button class="share-option facebook" onclick="shareToFacebook()">
          <div class="share-icon-wrapper">
            <svg class="share-icon" fill="currentColor" viewBox="0 0 24 24">
              <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
            </svg>
          </div>
          <div class="share-option-content">
            <div class="share-option-title">Share on Facebook</div>
            <div class="share-option-subtitle">Share with friends and family</div>
          </div>
        </button>

        <button class="share-option copy" id="copyLinkBtn" onclick="copyProjectLink()">
          <div class="share-icon-wrapper">
            <svg class="share-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
            </svg>
          </div>
          <div class="share-option-content">
            <div class="share-option-title" id="copyLinkText">Copy Link</div>
            <div class="share-option-subtitle" id="copyLinkSubtitle">Copy URL to clipboard</div>
          </div>
        </button>
      </div>
    </div>
  </div>

  <script>
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwhnvFEbtgvgXfV7hUr_WKtHRTtfR8RI9PZcUL-DhW9WCngld9N4HwQIxtZol4IY3eV/exec';
    const BASE_URL = window.location.origin + window.location.pathname;
    
    let projects = [];  
    let currentIndex = 0;
    let userFingerprint = '';

    // ===== EVENT BUFFER =====
    const EVENT_BUFFER_KEY = 'event_buffer';

    function getDeepLinkContext() {
     const params = new URLSearchParams(window.location.search);

      return {
        project: params.get('project'),
        ref: params.get('ref') || 'direct'
      };
    }

    
    function getEventBuffer() {
      return JSON.parse(localStorage.getItem(EVENT_BUFFER_KEY) || '[]');
    }

    function addToBuffer(event) {
      const buffer = getEventBuffer();
      buffer.push(event);
      localStorage.setItem(EVENT_BUFFER_KEY, JSON.stringify(buffer));
    }

    function clearBuffer() {
      localStorage.removeItem(EVENT_BUFFER_KEY);
    }

    // Generate user fingerprint
    function generateFingerprint() {
      const nav = navigator;
      const screen = window.screen;
      const guid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        const r = Math.random() * 16 | 0;
        const v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
      });
      
      const fingerprint = `${nav.userAgent}-${screen.width}x${screen.height}-${nav.language}-${guid}`;
      return btoa(fingerprint).substring(0, 32);
    }

    // Load projects from Google Sheets
    async function loadProjects() {
      try {
        const response = await fetch(GOOGLE_SCRIPT_URL);
        const data = await response.json();
        projects = data;
        
        if (projects.length > 0) {
          // Check URL for project ID
          const urlParams = new URLSearchParams(window.location.search);
          const projectId = urlParams.get('project');
          
          if (projectId) {
            const index = projects.findIndex(p => p.id === projectId);
            if (index !== -1) {
              currentIndex = index;
            }
          }
          
          populateDropdown();
          loadProject();
        } else {
          showError('No projects found');
        }
      } catch (error) {
        console.error('Error loading projects:', error);
        showError('Failed to load projects');
      }
    }

function sendEvent(type, projectId, meta = {}) {
  addToBuffer({
    project_id: projectId,
    type: type,
    ts: Date.now(),
    meta: meta
  });
}


    function syncBufferedEvents() {
      const events = getEventBuffer();
      if (!events.length) return;

      const payload = {
        action: 'sync',
        events: events,
        user_fingerprint: userFingerprint,
        user_agent: navigator.userAgent
      };

      navigator.sendBeacon(
        GOOGLE_SCRIPT_URL,
        JSON.stringify(payload)
      );

      clearBuffer();
    }

    // Update stat value with animation
    function updateStatValue(elementId, newValue) {
      const element = document.getElementById(elementId);
      if (element) {
        element.classList.add('updating');
        element.textContent = newValue.toLocaleString();
        setTimeout(() => {
          element.classList.remove('updating');
        }, 400);
      }
    }

    // Get current project URL
    function getCurrentProjectUrl() {
      const project = projects[currentIndex];
      if (!project) return BASE_URL;
      return `${BASE_URL}?project=${encodeURIComponent(project.id)}`;
    }

    // Generate platform-specific share content
    function generateLinkedInPost() {
      const project = projects[currentIndex];
      const url = getCurrentProjectUrl();
      
      const post = `${project.title}

${project.description}

Tools Used: ${project.tools}

${project.outcome}

Watch the full case study: ${url}

Live Project: ${project.projectLink}

#${project.category.replace(/\s+/g, '')} #WebDevelopment #CaseStudy`;

      return post;
    }

    function generateTwitterPost() {
      const project = projects[currentIndex];
      const url = getCurrentProjectUrl();
      const shortDesc = project.description.length > 120 
        ? project.description.substring(0, 117) + '...' 
        : project.description;
      
      let post = `${project.title}

${shortDesc}

Case study: ${url}

#${project.category.replace(/\s+/g, '')}`;

      // Ensure under 280 characters
      if (post.length > 280) {
        const evenShorterDesc = project.description.substring(0, 80) + '...';
        post = `${project.title}

${evenShorterDesc}

${url}

#${project.category.replace(/\s+/g, '')}`;
      }

      return post;
    }

    function generateFacebookPost() {
      const project = projects[currentIndex];
      const url = getCurrentProjectUrl();
      
      const post = `${project.title}

${project.description}

${project.outcome}

ðŸ”— Watch the full case study: ${url}

ðŸš€ Live Project: ${project.projectLink}

#${project.category.replace(/\s+/g, '')} #WebDevelopment`;

      return post;
    }

    // Populate dropdown with projects
    function populateDropdown() {
      const dropdownList = document.getElementById('dropdownList');
      dropdownList.innerHTML = projects.map((project, index) => `
        <div class="dropdown-item ${index === currentIndex ? 'active' : ''}" 
             data-index="${index}"
             onclick="selectProject(${index})">
          <div class="dropdown-item-title">${project.title}</div>
          <div class="dropdown-item-category">${project.category}</div>
        </div>
      `).join('');
    }

    // Toggle dropdown
    function toggleDropdown() {
      const dropdown = document.getElementById('dropdownMenu');
      const btn = document.getElementById('dropdownBtn');
      const isOpen = dropdown.classList.contains('show');
      
      // Close share modal if open
      closeShareModal();
      
      if (isOpen) {
        dropdown.classList.remove('show');
        btn.classList.remove('active');
      } else {
        dropdown.classList.add('show');
        btn.classList.add('active');
        document.getElementById('searchInput').focus();
      }
    }

    // Filter projects in dropdown
    function filterProjects() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const items = document.querySelectorAll('.dropdown-item');
      let hasResults = false;

      items.forEach(item => {
        const title = item.querySelector('.dropdown-item-title').textContent.toLowerCase();
        const category = item.querySelector('.dropdown-item-category').textContent.toLowerCase();
        
        if (title.includes(searchTerm) || category.includes(searchTerm)) {
          item.style.display = 'block';
          hasResults = true;
        } else {
          item.style.display = 'none';
        }
      });

      const dropdownList = document.getElementById('dropdownList');
      const existingNoResults = dropdownList.querySelector('.no-results');
      
      if (!hasResults && !existingNoResults) {
        const noResults = document.createElement('div');
        noResults.className = 'no-results';
        noResults.textContent = 'No projects found';
        dropdownList.appendChild(noResults);
      } else if (hasResults && existingNoResults) {
        existingNoResults.remove();
      }
    }

    // Select project from dropdown
    function selectProject(index) {
      currentIndex = index;
      loadProject();
      toggleDropdown();
      
      // Update URL without reload
      const project = projects[currentIndex];
      const newUrl = `${BASE_URL}?project=${encodeURIComponent(project.id)}`;
      window.history.pushState({}, '', newUrl);
    }

    // Toggle share modal
    function toggleShareModal() {
      const overlay = document.getElementById('shareModalOverlay');
      const isOpen = overlay.classList.contains('show');
      
      // Close dropdown if open
      const dropdown = document.getElementById('dropdownMenu');
      const btn = document.getElementById('dropdownBtn');
      dropdown.classList.remove('show');
      btn.classList.remove('active');
      
      if (isOpen) {
        closeShareModal();
      } else {
        openShareModal();
      }
    }

    function openShareModal() {
      const project = projects[currentIndex];
      const overlay = document.getElementById('shareModalOverlay');
      
      // Update modal content
      document.getElementById('shareCategory').textContent = project.category;
      document.getElementById('shareTitle').textContent = project.title;
      
      // Reset copy button
      const copyBtn = document.getElementById('copyLinkBtn');
      copyBtn.classList.remove('copied');
      document.getElementById('copyLinkText').textContent = 'Copy Link';
      document.getElementById('copyLinkSubtitle').textContent = 'Copy URL to clipboard';
      
      overlay.classList.add('show');
    }

    function closeShareModal() {
      const overlay = document.getElementById('shareModalOverlay');
      overlay.classList.remove('show');
    }

    function closeShareModalOnOverlay(event) {
      if (event.target === event.currentTarget) {
        closeShareModal();
      }
    }

    // Share to LinkedIn
function shareToLinkedIn() {
  const url = getCurrentProjectUrl();
  const shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`;
  window.open(shareUrl, '_blank', 'noopener,noreferrer');
}


    // Share to Twitter/X
    function shareToTwitter() {
      const text = generateTwitterPost();
      const shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;
      window.open(shareUrl, '_blank', 'noopener,noreferrer');
    }

    // Share to Facebook
    function shareToFacebook() {
      const url = getCurrentProjectUrl();
      const quote = generateFacebookPost();
      const shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}&quote=${encodeURIComponent(quote)}`;
      window.open(shareUrl, '_blank', 'noopener,noreferrer');
    }

    // Copy project link
    function copyProjectLink() {
      const url = getCurrentProjectUrl();
      
      navigator.clipboard.writeText(url).then(() => {
        const copyBtn = document.getElementById('copyLinkBtn');
        copyBtn.classList.add('copied');
        document.getElementById('copyLinkText').textContent = 'Link Copied!';
        document.getElementById('copyLinkSubtitle').textContent = 'Ready to paste anywhere';
        
        setTimeout(() => {
          closeShareModal();
        }, 1500);
      }).catch(err => {
        console.error('Failed to copy:', err);
        alert('Failed to copy link');
      });
    }

    // Close dropdowns when clicking outside
    document.addEventListener('click', function(e) {
      const dropdown = document.getElementById('dropdownMenu');
      const dropdownBtn = document.getElementById('dropdownBtn');
      
      if (!dropdown.contains(e.target) && !dropdownBtn.contains(e.target)) {
        dropdown.classList.remove('show');
        dropdownBtn.classList.remove('active');
      }
    });

    // Load and display current project
    function loadProject() {
      const project = projects[currentIndex];
      if (!project) return;

      // Update video
      const videoWrapper = document.getElementById('videoWrapper');
      videoWrapper.innerHTML = `
        <iframe
          src="https://www.youtube.com/embed/${project.videoId}"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
        ></iframe>
      `;

      // Update details
      const detailsSection = document.getElementById('detailsSection');
      const isLiked = checkIfLiked(project.id);
      
      detailsSection.innerHTML = `
        <span class="category-badge">${project.category}</span>
        <h3 class="project-title">${project.title}</h3>

        <!-- Stats -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-label">
              <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
              </svg>
              <span>Views</span>
            </div>
            <div class="stat-value" id="views">${(project.views || 0).toLocaleString()}</div>
          </div>

          <div class="stat-card">
            <div class="stat-label">
              <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
              </svg>
              <span>Likes</span>
            </div>
            <div class="stat-value" id="likes">${(project.likes || 0).toLocaleString()}</div>
          </div>
        </div>

        <!-- Like Button -->
        <button class="like-btn" id="likeBtn" onclick="likeProject()" ${isLiked ? 'disabled' : ''}>
          <svg class="icon ${isLiked ? 'filled' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
          </svg>
          <span>${isLiked ? 'Liked' : 'Like this project'}</span>
        </button>

        <!-- Description -->
        <div class="info-section">
          <div class="info-label">Description</div>
          <p class="info-text">${project.description}</p>
        </div>

        <!-- Tools -->
        <div class="info-section">
          <div class="info-label">Tools & Technologies</div>
          <p class="info-text">${project.tools}</p>
        </div>

        <!-- Outcome -->
        <div class="info-section">
          <div class="info-label">Business Impact</div>
          <p class="info-text">${project.outcome}</p>

          <div class="project-link-wrapper">
            <a
              href="${project.projectLink}"
              target="_blank"
              rel="noopener noreferrer"
              class="project-link-btn"
            >
              Live URL â†’
            </a>
          </div>
        </div>
      `;

      const deepLink = getDeepLinkContext();

        sendEvent('view', project.id, {
          ref: deepLink.ref,
          is_deep_link: Boolean(deepLink.project)
        });

      
      projects[currentIndex].views = (projects[currentIndex].views || 0) + 1;
      updateStatValue('views', projects[currentIndex].views);

      // Update dropdown active state
      populateDropdown();
      
      updateNavigationButtons();
    }

    // Check if user has liked this project
    function checkIfLiked(projectId) {
      return localStorage.getItem(`liked_${projectId}`) === 'true';
    }      

    function likeProject() {
      const project = projects[currentIndex];
      if (checkIfLiked(project.id)) return;

      sendEvent('like', project.id);

      project.likes = (project.likes || 0) + 1;
      updateStatValue('likes', project.likes);

      localStorage.setItem(`liked_${project.id}`, 'true');

      const likeBtn = document.getElementById('likeBtn');
      likeBtn.disabled = true;
      likeBtn.innerHTML = `
        <svg class="icon filled" fill="currentColor" viewBox="0 0 24 24">
          <path d="M12 21l-1.45-1.32C5.4 15.36 2 12.28 2 8.5
                   2 5.42 4.42 3 7.5 3
                   9.24 3 10.91 3.81 12 5.08
                   13.09 3.81 14.76 3 16.5 3
                   19.58 3 22 5.42 22 8.5
                   22 12.28 18.6 15.36 13.45 19.68L12 21z"/>
        </svg>
        <span>Liked</span>
      `;
    }

    // Navigation
    function updateNavigationButtons() {
      document.getElementById('prevBtn').disabled = currentIndex === 0;
      document.getElementById('nextBtn').disabled = currentIndex === projects.length - 1;
    }

    function previousProject() {
      if (currentIndex > 0) {
        currentIndex--;
        loadProject();
        
        // Update URL
        const project = projects[currentIndex];
        const newUrl = `${BASE_URL}?project=${encodeURIComponent(project.id)}`;
        window.history.pushState({}, '', newUrl);
      }
    }

    function nextProject() {
      if (currentIndex < projects.length - 1) {
        currentIndex++;
        loadProject();
        
        // Update URL
        const project = projects[currentIndex];
        const newUrl = `${BASE_URL}?project=${encodeURIComponent(project.id)}`;
        window.history.pushState({}, '', newUrl);
      }
    }

    function closeModal() {
      if (confirm('Are you sure you want to close?')) {
        window.close();
      }
    }

    function showError(message) {
      document.getElementById('videoWrapper').innerHTML = `<div class="loading">${message}</div>`;
      document.getElementById('detailsSection').innerHTML = `<div class="loading">${message}</div>`;
    }

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        const dropdown = document.getElementById('dropdownMenu');
        const shareModal = document.getElementById('shareModalOverlay');
        
        if (dropdown.classList.contains('show')) {
          toggleDropdown();
        } else if (shareModal.classList.contains('show')) {
          closeShareModal();
        } else {
          closeModal();
        }
      }
      if (e.key === 'ArrowLeft') previousProject();
      if (e.key === 'ArrowRight') nextProject();
    });

    document.addEventListener('visibilitychange', () => {
      if (document.visibilityState === 'hidden') {
        syncBufferedEvents();
      }
    });

    window.addEventListener('pagehide', syncBufferedEvents);

    // Initialize
    userFingerprint = generateFingerprint();
    loadProjects();
  </script>
</body>
</html>
